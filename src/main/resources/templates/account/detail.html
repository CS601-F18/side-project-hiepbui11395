<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Account Info</title>
	<th:block th:include="/_static"></th:block>
</head>
<body>
	<th:block th:include="/_menu"></th:block>

	<div class="page-title">Account Info</div>
	<div class="account-container">
		<ul>
			<li>Username: <span th:utext="${account.username}"></span></li>
			<li>Email: <span th:utext="${account.email}"></span></li>
			<li>Games:
				<ul>
					<li th:each="game : ${account.games}"
						th:utext="${game.name}"></li>
				</ul>
				<button id="myBtn">Open Modal</button>
			</li>
		</ul>
	</div>

	<th:block th:include="/_footer"></th:block>


	<!-- The Modal -->
	<div id="addGameModel" class="modal">

		<!-- Modal content -->
		<div class="modal-content">
			<div class="modal-header">
				<span class="close">&times;</span>
				<h2>Add game</h2>
			</div>
			<div class="modal-body">
				<form autocomplete="off">
					<div class="autocomplete">
						Game: <input id="gameName" type="text" name="game" required>
					</div>
					<br /> <label for="startTime">Start time: </label> <input
						id="startTime" type="time" name="startTime"><br /> <label
						for="endTime">End time: </label> <input id="endTime" type="time"
						name="endTime"><br />
					<button id="btnAddGame">Submit</button>
				</form>
			</div>
			<div class="modal-footer">
				<h3></h3>
			</div>
		</div>

	</div>
</body>
<script>
	var games;
	$.ajax({
		type : "GET",
		url : "/api/games",
		success : function(result) {
			games = result;
			autocomplete(document.getElementById("gameName"), games);
		},
		error : function(result) {
			// do something.
		}
	});

	// Get the modal
	var modal = document.getElementById('addGameModel');

	// Get the button that opens the modal
	var btn = document.getElementById("myBtn");

	// Get the <span> element that closes the modal
	var span = document.getElementsByClassName("close")[0];

	// When the user clicks on the button, open the modal 
	btn.onclick = function() {
		modal.style.display = "block";
	}

	// When the user clicks on <span> (x), close the modal
	span.onclick = function() {
		modal.style.display = "none";
	}

	// When the user clicks anywhere outside of the modal, close it
	window.onclick = function(event) {
		if (event.target == modal) {
			modal.style.display = "none";
		}
	}
	$(document).ready(function() {
		$("#btnAddGame").click(function(e) {
			e.preventDefault();
			$.ajax({
				type : "POST",
				url : "/account/game/",
				data : {
					game : $("#gameName").val(),
					startTime : $("#startTime").val(),
					endTime : $("#endTime").val()
				},
				success : function(result) {
					alert('ok');
				},
				error : function(result) {
					alert('error');
				}
			});
		});
	});
</script>
</html>